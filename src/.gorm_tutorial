package main

import (
	"github.com/jinzhu/gorm"
  	_ "github.com/jinzhu/gorm/dialects/mysql"
  	"log"
)

type Role struct {
	Id int
	Name string
}

type User struct {
	Id int
	Name string
	Email string
	Role Role
}

func main() {
	var user User

	gorm, err := gorm.Open("mysql", "admin:M@R!4dB@tcp(localhost:3306)/tripola")
	defer gorm.Close()

	query := gorm.Table("user").Select("user.id, user.name, user.email, role.id, role.name").Joins("JOIN role ON user.role_id = role.id")
	rows, err := query.Rows()
	if err != nil {
		log.Println(err.Error())
		return
	}

	defer rows.Close()
	for rows.Next() {
		if err := rows.Scan(&user.Id, &user.Name, &user.Email, &user.Role.Id, &user.Role.Name); err != nil {
			log.Println(err.Error())
		}
	}
}